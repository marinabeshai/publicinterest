# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
import helpers.search_u as search 
import utils.dict_utils as dict_utils  
import helpers.official as official
import utils.constants as constants 
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
class Congress:
   # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------    
    def __init__(self, number, senate_members, house_members):
        self.number = number 
        self.senate_members = senate_members
        self.house_members = house_members
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
  
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def debug(self):
        return(
            "self.number :{}\n num_of_senators: {}\n senate_party: {}\nsenate_members: {}\nnum_of_representatives: {}\nhouse_party: {}\nhouse_members: {}".
            format(self.number, self.get_count_senate(), self.senate_party, self.senate_members, self.get_count_house(), self.house_party, self.house_members)
        )
   # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

   # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_count_total(self):    
        return (len(self.house_members) + len(self.senate_members))
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_count_senate(self): 
        return len(self.senate_members)
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_count_house(self):        
        return len(self.house_members) 
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_everyone(self):
        l = []
        
        for name, link in self.house_members:
            l.append((name, link.strip()))
        for name, link in self.senate_members:
            l.append((name, link.strip()))
        
        return l
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_house_party(self):
        d = {}
        l = []
        
        for name, _ in self._house_members:
            l.append(name)

        for name in l:
            d = dict_utils.increment_dictionary(d, search.congress_gov_get(name, party_only=True))
            
        return d 
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    def get_senate_party(self):
        d = {}
        l = []
        
        for name, _ in self._senate_members:
            l.append(name)
            
        for name in l:
            d = dict_utils.increment_dictionary(d, search.congress_gov_get(name, party_only=True))
            
        return d 
    # -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_officials(everyone=False, senate=False, house=False):
    # l = list(range(112, 118))
    l = list(range(116, 117))

    all_officials_list = []
    all_officials_set = set()
    
    for i in l:
        if everyone: 
            all_officials_list.append(search.get_congress(i).get_everyone())
        if senate: 
            all_officials_list.append(search.get_congress(i).senate_members)
        if house: 
            all_officials_list.append(search.get_congress(i).house_members)

    all_officials_list = [item for sublist in all_officials_list for item in sublist ]
    
    for name, link in all_officials_list:
        name = official.get_canonical_name(name)
        if 'Bishop' in name:
            
            possible_redirection_link = search.get_redirection_link(link)
            
            if (name, possible_redirection_link) not in all_officials_set:
                all_officials_set.add((name, possible_redirection_link))
                
            print(name, link, possible_redirection_link)

    res = []
    for name, link in all_officials_set:
        res.append(name)
        
    return res
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Takes 20minutes. 
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_all_officials():
    return get_officials(everyone=True)
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Takes 20minutes. 
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_house_officials():
    return get_officials(house=True)
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# Takes 20minutes. 
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_senate_officials():
    return get_officials(senate=True)
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------