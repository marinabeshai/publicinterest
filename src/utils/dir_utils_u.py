import pandas as pd 
import os 

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_data():
    path = '../curr/senate-10182021.csv'
    csvreader = pd.read_csv(path)
    title = csvreader.columns[8]
    rows = csvreader.iterrows()
    return title, rows
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# @TODO
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_mapping(errors=False):
    if errors:
        path = '../curr/ticker_to_industry_mapping_ERRORS.csv'
    else:
        path = '../curr/ticker_to_industry_mapping.csv'
    return pd.read_csv(path)
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------





# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# @TODO
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def get_filename(path_csv, filename):
    cwd = os.getcwd()
    make_dir(path_csv)
    return "{path}{slash}{filename}.csv".format(path="{cwd}/{path}".format(cwd=cwd, path=path_csv), slash=('/' if path_csv else None), filename=filename)
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# @TODO
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
def make_dir(path):
    cwd = os.getcwd()
    try:
        if path:
            dir = "{cwd}/{path}".format(cwd=cwd, path=path)
            os.makedirs(dir)
    except FileExistsError:
        pass
# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------



# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------


    
def makesubdir(path, last_dir):
    return "{}/{}".format(path, last_dir)

# --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
